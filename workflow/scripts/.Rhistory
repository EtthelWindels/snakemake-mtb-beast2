ggsave("SuppFig1_bd_05.png", plot=plot_all, path="/Users/ewindels/Documents/Latency_analyses_v2/manuscript/figures", width=250, height=190, units="mm", bg='white')
ggsave("SuppFig1_bd_05.svg", plot=plot_all, path="/Users/ewindels/Documents/Latency_analyses_v2/manuscript/figures", width=250, height=190, units="mm", bg='white')
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig1_bd_1.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig1_bd_05_v2.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig1_bd_1_v2.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_Fig3_bdmm.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig4_bdmm_05.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig6_bdmm_bdsky.R", echo=TRUE)
library(ggplot2)
library(dplyr)
library(stringr)
library(cowplot)
library(hrbrthemes)
library(ggridges)
# Malawi
LOGFILE_Ma_1 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_Ma_L1/bdmm_bdsky_fixedRe_Ma_L1.log"
LOGFILE_Ma_2 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_Ma_L2/bdmm_bdsky_fixedRe_Ma_L2.log"
LOGFILE_Ma_3 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_Ma_L3/bdmm_bdsky_fixedRe_Ma_L3.log"
LOGFILE_Ma_4 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_Ma_L4/bdmm_bdsky_fixedRe_Ma_L4.log"
# Tanzania
LOGFILE_Ta_1 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_Ta_L1/bdmm_bdsky_fixedRe_Ta_L1.log"
LOGFILE_Ta_2 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_Ta_L2/bdmm_bdsky_fixedRe_Ta_L2.log"
LOGFILE_Ta_3 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_Ta_L3/bdmm_bdsky_fixedRe_Ta_L3.log"
LOGFILE_Ta_4 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_Ta_L4/bdmm_bdsky_fixedRe_Ta_L4.log"
# The Gambia
LOGFILE_TG_2 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_TG_L2/bdmm_bdsky_fixedRe_TG_L2.log"
LOGFILE_TG_4 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_TG_L4/bdmm_bdsky_fixedRe_TG_L4.log"
LOGFILE_TG_6 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_TG_L6/bdmm_bdsky_fixedRe_TG_L6.log"
# Vietnam
LOGFILE_VN_1 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_VN_L1/bdmm_bdsky_fixedRe_VN_L1.log"
LOGFILE_VN_2 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_VN_L2/bdmm_bdsky_fixedRe_VN_L2.log"
LOGFILE_VN_4 <- "/Users/ewindels/Documents/Latency_analyses_v2/snakemake-phylo-beast2/results/analyses/bdmm_bdsky_fixedRe/bdmm_bdsky_fixedRe_VN_L4/bdmm_bdsky_fixedRe_VN_L4.log"
loadTrajectories <- function(filename, burninFrac=0, subsample=NA) {
df_in <- as.matrix(read.table(filename, header=T))
if (burninFrac>0) {
n <- dim(df_in)[1]
df_in <- df_in[-(1:ceiling(burninFrac*n)),]
}
if (!is.na(subsample)) {
indices <- unique(round(seq(1, dim(df_in)[1], length.out=subsample)))
df_in <- df_in[indices,]
}
return(df_in)
}
logfile_Ma_1 <- loadTrajectories(LOGFILE_Ma_1, burninFrac=0) %>%
as.data.frame()
logfile_Ma_1$bUR <- logfile_Ma_1$becomeUninfectiousRate.4
logfile_Ma_1$inf_period <- 1/logfile_Ma_1$bUR
logfile_Ma_1$migr <- logfile_Ma_1$rateMatrix.3
logfile_Ma_1$latent_period <- 1/logfile_Ma_1$migr
Ma_1_uninf_mean <- mean(logfile_Ma_1$migr)
logfile_Ma_2 <- loadTrajectories(LOGFILE_Ma_2, burninFrac=0) %>%
as.data.frame()
logfile_Ma_2$bUR <- logfile_Ma_2$becomeUninfectiousRate.4
logfile_Ma_2$inf_period <- 1/logfile_Ma_2$bUR
logfile_Ma_2$migr <- logfile_Ma_2$rateMatrix.3
logfile_Ma_2$latent_period <- 1/logfile_Ma_2$migr
Ma_2_uninf_mean <- mean(logfile_Ma_2$migr)
logfile_Ma_3 <- loadTrajectories(LOGFILE_Ma_3, burninFrac=0) %>%
as.data.frame()
logfile_Ma_3$bUR <- logfile_Ma_3$becomeUninfectiousRate.4
logfile_Ma_3$inf_period <- 1/logfile_Ma_3$bUR
logfile_Ma_3$migr <- logfile_Ma_3$rateMatrix.3
logfile_Ma_3$latent_period <- 1/logfile_Ma_3$migr
Ma_3_uninf_mean <- mean(logfile_Ma_3$migr)
logfile_Ma_4 <- loadTrajectories(LOGFILE_Ma_4, burninFrac=0) %>%
as.data.frame()
logfile_Ma_4$bUR <- logfile_Ma_4$becomeUninfectiousRate.4
logfile_Ma_4$inf_period <- 1/logfile_Ma_4$bUR
logfile_Ma_4$migr <- logfile_Ma_4$rateMatrix.3
logfile_Ma_4$latent_period <- 1/logfile_Ma_4$migr
Ma_4_uninf_mean <- mean(logfile_Ma_4$migr)
logfile_Ta_1 <- loadTrajectories(LOGFILE_Ta_1, burninFrac=0) %>%
as.data.frame()
logfile_Ta_1$bUR <- logfile_Ta_1$becomeUninfectiousRate.4
logfile_Ta_1$inf_period <- 1/logfile_Ta_1$bUR
logfile_Ta_1$migr <- logfile_Ta_1$rateMatrix.3
logfile_Ta_1$latent_period <- 1/logfile_Ta_1$migr
Ta_1_uninf_mean <- mean(logfile_Ta_1$migr)
logfile_Ta_2 <- loadTrajectories(LOGFILE_Ta_2, burninFrac=0) %>%
as.data.frame()
logfile_Ta_2$bUR <- logfile_Ta_2$becomeUninfectiousRate.4
logfile_Ta_2$inf_period <- 1/logfile_Ta_2$bUR
logfile_Ta_2$migr <- logfile_Ta_2$rateMatrix.3
logfile_Ta_2$latent_period <- 1/logfile_Ta_2$migr
Ta_2_uninf_mean <- mean(logfile_Ta_2$migr)
logfile_Ta_3 <- loadTrajectories(LOGFILE_Ta_3, burninFrac=0) %>%
as.data.frame()
logfile_Ta_3$bUR <- logfile_Ta_3$becomeUninfectiousRate.4
logfile_Ta_3$inf_period <- 1/logfile_Ta_3$bUR
logfile_Ta_3$migr <- logfile_Ta_3$rateMatrix.3
logfile_Ta_3$latent_period <- 1/logfile_Ta_3$migr
Ta_3_uninf_mean <- mean(logfile_Ta_3$migr)
logfile_Ta_4 <- loadTrajectories(LOGFILE_Ta_4, burninFrac=0) %>%
as.data.frame()
logfile_Ta_4$bUR <- logfile_Ta_4$becomeUninfectiousRate.4
logfile_Ta_4$inf_period <- 1/logfile_Ta_4$bUR
logfile_Ta_4$migr <- logfile_Ta_4$rateMatrix.3
logfile_Ta_4$latent_period <- 1/logfile_Ta_4$migr
Ta_4_uninf_mean <- mean(logfile_Ta_4$migr)
logfile_TG_2 <- loadTrajectories(LOGFILE_TG_2, burninFrac=0) %>%
as.data.frame()
logfile_TG_2$bUR <- logfile_TG_2$becomeUninfectiousRate.4
logfile_TG_2$inf_period <- 1/logfile_TG_2$bUR
logfile_TG_2$migr <- logfile_TG_2$rateMatrix.3
logfile_TG_2$latent_period <- 1/logfile_TG_2$migr
TG_2_uninf_mean <- mean(logfile_TG_2$migr)
logfile_TG_4 <- loadTrajectories(LOGFILE_TG_4, burninFrac=0) %>%
as.data.frame()
logfile_TG_4$bUR <- logfile_TG_4$becomeUninfectiousRate.4
logfile_TG_4$inf_period <- 1/logfile_TG_4$bUR
logfile_TG_4$migr <- logfile_TG_4$rateMatrix.3
logfile_TG_4$latent_period <- 1/logfile_TG_4$migr
TG_4_uninf_mean <- mean(logfile_TG_4$migr)
logfile_TG_6 <- loadTrajectories(LOGFILE_TG_6, burninFrac=0) %>%
as.data.frame()
logfile_TG_6$bUR <- logfile_TG_6$becomeUninfectiousRate.4
logfile_TG_6$inf_period <- 1/logfile_TG_6$bUR
logfile_TG_6$migr <- logfile_TG_6$rateMatrix.3
logfile_TG_6$latent_period <- 1/logfile_TG_6$migr
TG_6_uninf_mean <- mean(logfile_TG_6$migr)
logfile_VN_1 <- loadTrajectories(LOGFILE_VN_1, burninFrac=0) %>%
as.data.frame()
logfile_VN_1$bUR <- logfile_VN_1$becomeUninfectiousRate.4
logfile_VN_1$inf_period <- 1/logfile_VN_1$bUR
logfile_VN_1$migr <- logfile_VN_1$rateMatrix.3
logfile_VN_1$latent_period <- 1/logfile_VN_1$migr
VN_1_uninf_mean <- mean(logfile_VN_1$migr)
logfile_VN_2 <- loadTrajectories(LOGFILE_VN_2, burninFrac=0) %>%
as.data.frame()
logfile_VN_2$bUR <- logfile_VN_2$becomeUninfectiousRate.4
logfile_VN_2$inf_period <- 1/logfile_VN_2$bUR
logfile_VN_2$migr <- logfile_VN_2$rateMatrix.3
logfile_VN_2$latent_period <- 1/logfile_VN_2$migr
VN_2_uninf_mean <- mean(logfile_VN_2$migr)
logfile_VN_4 <- loadTrajectories(LOGFILE_VN_4, burninFrac=0) %>%
as.data.frame()
logfile_VN_4$bUR <- logfile_VN_4$becomeUninfectiousRate.4
logfile_VN_4$inf_period <- 1/logfile_VN_4$bUR
logfile_VN_4$migr <- logfile_VN_4$rateMatrix.3
logfile_VN_4$latent_period <- 1/logfile_VN_4$migr
VN_4_uninf_mean <- mean(logfile_VN_4$migr)
n_Ma <- dim(logfile_Ma_1)[1] + dim(logfile_Ma_2)[1] + dim(logfile_Ma_3)[1] + dim(logfile_Ma_4)[1]
n_Ta <- dim(logfile_Ta_1)[1] + dim(logfile_Ta_2)[1] + dim(logfile_Ta_3)[1] + dim(logfile_Ta_4)[1]
n_TG <- dim(logfile_TG_2)[1] + dim(logfile_TG_4)[1] + dim(logfile_TG_6)[1]
n_VN <- dim(logfile_VN_1)[1] + dim(logfile_VN_2)[1] + dim(logfile_VN_4)[1]
all_lin <- data.frame(country=c(rep("Malawi",n_Ma),rep("Tanzania",n_Ta),rep("TheGambia",n_TG),rep("Vietnam",n_VN)),
lineage=c(rep("L1",dim(logfile_Ma_1)[1]), rep("L2",dim(logfile_Ma_2)[1]), rep("L3",dim(logfile_Ma_3)[1]), rep("L4",dim(logfile_Ma_4)[1]),rep("L1",dim(logfile_Ta_1)[1]), rep("L2",dim(logfile_Ta_2)[1]), rep("L3",dim(logfile_Ta_3)[1]), rep("L4",dim(logfile_Ta_4)[1]),rep("L2",dim(logfile_TG_2)[1]), rep("L4",dim(logfile_TG_4)[1]), rep("L6",dim(logfile_TG_6)[1]),rep("L1",dim(logfile_VN_1)[1]), rep("L2",dim(logfile_VN_2)[1]), rep("L4",dim(logfile_VN_4)[1])),
inf_period=c(logfile_Ma_1$inf_period, logfile_Ma_2$inf_period, logfile_Ma_3$inf_period, logfile_Ma_4$inf_period,logfile_Ta_1$inf_period, logfile_Ta_2$inf_period, logfile_Ta_3$inf_period, logfile_Ta_4$inf_period, logfile_TG_2$inf_period, logfile_TG_4$inf_period, logfile_TG_6$inf_period, logfile_VN_1$inf_period, logfile_VN_2$inf_period, logfile_VN_4$inf_period),
latent_period=c(logfile_Ma_1$latent_period, logfile_Ma_2$latent_period, logfile_Ma_3$latent_period, logfile_Ma_4$latent_period,logfile_Ta_1$latent_period, logfile_Ta_2$latent_period, logfile_Ta_3$latent_period, logfile_Ta_4$latent_period, logfile_TG_2$latent_period, logfile_TG_4$latent_period, logfile_TG_6$latent_period, logfile_VN_1$latent_period, logfile_VN_2$latent_period, logfile_VN_4$latent_period))
all_lin$lineage <- as.factor(all_lin$lineage)
all_lin$lineage <- factor(all_lin$lineage, levels=c("L6","L4","L3","L2","L1"))
x <- seq(0,10,by=0.01)
all_lin_uninf_distr <- data.frame(country=c(rep("Malawi",4*length(x)),rep("Tanzania",4*length(x)),rep("The Gambia",3*length(x)),rep("Vietnam",3*length(x))),
lineage=c(rep("L1",length(x)),rep("L2",length(x)),rep("L3",length(x)),rep("L4",length(x)),rep("L1",length(x)),rep("L2",length(x)),rep("L3",length(x)),rep("L4",length(x)),rep("L2",length(x)),rep("L4",length(x)),rep("L6",length(x)),rep("L1",length(x)),rep("L2",length(x)),rep("L4",length(x))),
exp_x=rep(x,times=14),
exp_y=c(dexp(x,rate=Ma_1_uninf_mean),dexp(x,rate=Ma_2_uninf_mean),dexp(x,rate=Ma_3_uninf_mean),dexp(x,rate=Ma_4_uninf_mean),dexp(x,rate=Ta_1_uninf_mean),dexp(x,rate=Ta_2_uninf_mean),dexp(x,rate=Ta_3_uninf_mean),dexp(x,rate=Ta_4_uninf_mean),dexp(x,rate=TG_2_uninf_mean),dexp(x,rate=TG_4_uninf_mean),dexp(x,rate=TG_6_uninf_mean),dexp(x,rate=VN_1_uninf_mean),dexp(x,rate=VN_2_uninf_mean),dexp(x,rate=VN_4_uninf_mean)))
latentperiod_Ma <- ggplot(all_lin[all_lin$country=="Malawi",], aes(lineage, x=latent_period, fill=lineage, colour=lineage)) +
geom_density_ridges(alpha=0.9, show.legend = F)+
xlab("Infected uninfectious period (years)") +
ylab("")+
labs(title=expression(atop(bold("Malawi")))) +
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
plot.title = element_text(size=14, hjust=0.5),
plot.margin = margin(t=0.5, b=0.5, l=0.5, unit="cm")) +
xlim(0,4)+
scale_fill_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#bfcbdbff','#8a96a3ff','darksalmon'))+
scale_colour_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#bfcbdbff','#8a96a3ff','darksalmon'))
latentperiod_Ta <- ggplot(all_lin[all_lin$country=="Tanzania",], aes(lineage, x=latent_period, fill=lineage, colour=lineage)) +
geom_density_ridges(alpha=0.9, show.legend = F)+
xlab("Infected uninfectious period (years)") +
ylab("")+
labs(title=expression(atop(bold("Tanzania")))) +
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
plot.title = element_text(size=14, hjust=0.5),
plot.margin = margin(t=0.5, b=0.5, unit="cm")) +
xlim(0,4)+
scale_fill_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#bfcbdbff','#8a96a3ff','darksalmon'))+
scale_colour_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#bfcbdbff','#8a96a3ff','darksalmon'))
latentperiod_TG <- ggplot(all_lin[all_lin$country=="TheGambia",], aes(lineage, x=latent_period, fill=lineage, colour=lineage)) +
geom_density_ridges(alpha=0.9, show.legend = F)+
xlab("Infected uninfectious period (years)") +
ylab("")+
labs(title=expression(atop(bold("The Gambia")))) +
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
plot.title = element_text(size=14, hjust=0.5),
plot.margin = margin(t=0.5, b=0.5, unit="cm")) +
xlim(0,6)+
scale_fill_manual(labels=c('L2','L4','L6'),values=c('indianred4','slategray1','#8a96a3ff'))+
scale_colour_manual(labels=c('L2','L4','L6'),values=c('indianred4','slategray1','#8a96a3ff'))
latentperiod_VN <- ggplot(all_lin[all_lin$country=="Vietnam",], aes(lineage, x=latent_period, fill=lineage, colour=lineage)) +
geom_density_ridges(alpha=0.9, show.legend = F)+
xlab("Infected uninfectious period (years)") +
ylab("")+
labs(title=expression(atop(bold("Vietnam")))) +
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
plot.title = element_text(size=14, hjust=0.5),
plot.margin = margin(t=0.5, b=0.5, r=0.5, unit="cm")) +
xlim(0,6)+
scale_fill_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#8a96a3ff','darksalmon'))+
scale_colour_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#8a96a3ff','darksalmon'))
distr_Ma <- ggplot(all_lin_uninf_distr[all_lin_uninf_distr$country=="Malawi",], aes(lineage, x=exp_x, y=exp_y, colour=lineage)) +
geom_line(show.legend = T, linewidth=1)+
xlab("Time until infectiousness (years)") +
ylab("Density")+
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
# plot.title = element_blank(),
legend.position = c(0.8,0.75),
legend.background = element_rect(fill="white", colour="white"),
legend.title = element_blank(),
legend.text = element_text(size=10, vjust=0.5),
plot.margin = margin(b=0.5, l=0.5, unit="cm")) +
xlim(0,6) +
ylim(0,1) +
scale_colour_manual(labels=c('L1','L2','L3','L4'),values=c('darksalmon','#8a96a3ff','#bfcbdbff','slategray1'))
distr_Ta <- ggplot(all_lin_uninf_distr[all_lin_uninf_distr$country=="Tanzania",], aes(lineage, x=exp_x, y=exp_y, colour=lineage)) +
geom_line(show.legend = T, linewidth=1)+
xlab("Time until infectiousness (years)") +
ylab("Density")+
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
# plot.title = element_blank(),
legend.position = c(0.8,0.75),
legend.background = element_rect(fill="white", colour="white"),
legend.title = element_blank(),
legend.text = element_text(size=10, vjust=0.5),
plot.margin = margin(b=0.5, unit="cm")) +
xlim(0,6) +
ylim(0,1) +
scale_colour_manual(labels=c('L1','L2','L3','L4'),values=c('darksalmon','#8a96a3ff','#bfcbdbff','slategray1'))
distr_TG <- ggplot(all_lin_uninf_distr[all_lin_uninf_distr$country=="The Gambia",], aes(lineage, x=exp_x, y=exp_y, colour=lineage)) +
geom_line(show.legend = T, linewidth=1)+
xlab("Time until infectiousness (years)") +
ylab("Density")+
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
# plot.title = element_blank(),
legend.position = c(0.8,0.8),
legend.background = element_rect(fill="white", colour="white"),
legend.title = element_blank(),
legend.text = element_text(size=10, vjust=0.5),
plot.margin = margin(b=0.5, unit="cm")) +
xlim(0,6) +
ylim(0,1) +
scale_colour_manual(labels=c('L2','L4','L6'),values=c('#8a96a3ff','slategray1','indianred4'))
distr_VN <- ggplot(all_lin_uninf_distr[all_lin_uninf_distr$country=="Vietnam",], aes(lineage, x=exp_x, y=exp_y, colour=lineage)) +
geom_line(show.legend = T, linewidth=1)+
xlab("Time until infectiousness (years)") +
ylab("Density")+
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
# plot.title = element_blank(),
legend.position = c(0.8,0.8),
legend.background = element_rect(fill="white", colour="white"),
legend.title = element_blank(),
legend.text = element_text(size=10, vjust=0.5),
plot.margin = margin(b=0.5, r=0.5, unit="cm")) +
xlim(0,6) +
ylim(0,1) +
scale_colour_manual(labels=c('L1','L2','L4'),values=c('darksalmon','#8a96a3ff','slategray1'))
infperiod_Ma <- ggplot(all_lin[all_lin$country=="Malawi",], aes(lineage, x=inf_period, fill=lineage, colour=lineage)) +
geom_density_ridges(alpha=0.9, show.legend = F)+
xlab("Infectious period (years)") +
ylab("")+
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
# plot.title = element_blank(),
plot.margin = margin(b=0.5, l=0.5, unit="cm")) +
xlim(0,1.5)+
scale_fill_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#bfcbdbff','#8a96a3ff','darksalmon'))+
scale_colour_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#bfcbdbff','#8a96a3ff','darksalmon'))
infperiod_Ta <- ggplot(all_lin[all_lin$country=="Tanzania",], aes(lineage, x=inf_period, fill=lineage, colour=lineage)) +
geom_density_ridges(alpha=0.9, show.legend = F)+
xlab("Infectious period (years)") +
ylab("")+
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
# plot.title = element_blank(),
plot.margin = margin(b=0.5, unit="cm")) +
xlim(0,1.5)+
scale_fill_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#bfcbdbff','#8a96a3ff','darksalmon'))+
scale_colour_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#bfcbdbff','#8a96a3ff','darksalmon'))
infperiod_TG <- ggplot(all_lin[all_lin$country=="TheGambia",], aes(lineage, x=inf_period, fill=lineage, colour=lineage)) +
geom_density_ridges(alpha=0.9, show.legend = F)+
xlab("Infectious period (years)") +
ylab("")+
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
# plot.title = element_blank(),
plot.margin = margin(b=0.5, unit="cm")) +
xlim(0,1.5)+
scale_fill_manual(labels=c('L2','L4','L6'),values=c('indianred4','slategray1','#8a96a3ff'))+
scale_colour_manual(labels=c('L2','L4','L6'),values=c('indianred4','slategray1','#8a96a3ff'))
infperiod_VN <- ggplot(all_lin[all_lin$country=="Vietnam",], aes(lineage, x=inf_period, fill=lineage, colour=lineage)) +
geom_density_ridges(alpha=0.9, show.legend = F)+
xlab("Infectious period (years)") +
ylab("")+
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
# plot.title = element_blank(),
plot.margin = margin(b=0.5, r=0.5, unit="cm")) +
xlim(0,1.5)+
scale_fill_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#8a96a3ff','darksalmon'))+
scale_colour_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#8a96a3ff','darksalmon'))
plots_1 <- align_plots(latentperiod_Ma, infperiod_Ma, align='v', axis='l')
latentperiod_Ma
rlang::last_trace()
rlang::last_trace(drop = FALSE)
plots_2 <- align_plots(latentperiod_Ta, infperiod_Ta, align='v', axis='l')
ggplot(all_lin[all_lin$country=="Malawi",], aes(lineage, x=latent_period, fill=lineage, colour=lineage)) +
geom_density_ridges(alpha=0.9, show.legend = F)+
xlab("Infected uninfectious period (years)") +
ylab("")+
labs(title=expression(atop(bold("Malawi")))) +
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
plot.title = element_text(size=14, hjust=0.5),
plot.margin = margin(t=0.5, b=0.5, l=0.5, unit="cm")) +
xlim(0,4)+
scale_fill_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#bfcbdbff','#8a96a3ff','darksalmon'))+
scale_colour_manual(labels=c('L1','L2','L3','L4'),values=c('slategray1','#bfcbdbff','#8a96a3ff','darksalmon'))
head(all_lin)
logfile_Ma_1 <- loadTrajectories(LOGFILE_Ma_1, burninFrac=0) %>%
as.data.frame()
logfile_Ma_1$bUR <- logfile_Ma_1$becomeUninfectiousRate.4
logfile_Ma_1$bUR
logfile_Ma_1$inf_period <- 1/logfile_Ma_1$bUR
logfile_Ma_1$inf_period
logfile_Ma_1$migr <- logfile_Ma_1$rateMatrix.3
logfile_Ma_1$migr
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig6_bdmm_bdsky.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig6_bdmm_bdsky.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig6_bdmm_bdsky.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig6_bdmm_bdsky.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig6_bdmm_bdsky.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig6_bdmm_bdsky.R", echo=TRUE)
source("~/Documents/Latency_analyses_v2/manuscript/figure_scripts/manuscript_SuppFig6_bdmm_bdsky.R", echo=TRUE)
library(ggplot2)
library(dplyr)
library(stringr)
library(cowplot)
library(hrbrthemes)
library(ggridges)
LOGFILE_Ma_1 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_Ma_L1/bdmm_sampl025_Ma_L1.log"
LOGFILE_Ma_2 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_Ma_L2/bdmm_sampl025_Ma_L2.log"
LOGFILE_Ma_3 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_Ma_L3/bdmm_sampl025_Ma_L3.log"
LOGFILE_Ma_4 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_Ma_L4/bdmm_sampl025_Ma_L4.log"
# Tanzania
LOGFILE_Ta_1 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_Ta_L1/bdmm_sampl025_Ta_L1.log"
LOGFILE_Ta_2 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_Ta_L2/bdmm_sampl025_Ta_L2.log"
LOGFILE_Ta_3 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_Ta_L3/bdmm_sampl025_Ta_L3.log"
LOGFILE_Ta_4 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_Ta_L4/bdmm_sampl025_Ta_L4.log"
# The Gambia
LOGFILE_TG_2 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_TG_L2/bdmm_sampl025_TG_L2.log"
LOGFILE_TG_4 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_TG_L4/bdmm_sampl025_TG_L4.log"
LOGFILE_TG_6 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_TG_L6/bdmm_sampl025_TG_L6.log"
# Vietnam
LOGFILE_VN_1 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_VN_L1/bdmm_sampl025_VN_L1.log"
LOGFILE_VN_2 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_VN_L2/bdmm_sampl025_VN_L2.log"
LOGFILE_VN_4 <- "/Users/ewindels/Documents/Projects/Latency_analyses_v2/snakemake-mtb-beast2/results/analyses/bdmm_sampl025/bdmm_sampl025_VN_L4/bdmm_sampl025_VN_L4.log"
load_trajectories <- function(filename, burninFrac=0, subsample=NA) {
df_in <- as.matrix(read.table(filename, header=T))
if (burninFrac>0) {
n <- dim(df_in)[1]
df_in <- df_in[-(1:ceiling(burninFrac*n)),]
}
if (!is.na(subsample)) {
indices <- unique(round(seq(1, dim(df_in)[1], length.out=subsample)))
df_in <- df_in[indices,]
}
return(df_in)
}
get_extended_log <- function(path_to_logfile) {
log <- load_trajectories(path_to_logfile, burninFrac=0) %>%
as.data.frame()
log$bUR <- log$becomeUninfectiousRate.2
log$inf_period <- 1/log$bUR
log$Re <- log$R0AmongDemes.2
log$lambda <- log$Re*log$bUR
log$migr <- log$rateMatrix.1
log$latent_period <- 1/log$migr
log$inf_period_tot <- log$latent_period + log$inf_period
log$time_until_transm <- log$latent_period + 1/log$lambda
return(log)
}
get_migr_mean <- function(extended_logfile){
post_mean <- mean(extended_logfile$migr)
return(post_mean)
}
# Malawi
log_Ma_1 <- get_extended_log(LOGFILE_Ma_1)
log_Ma_2 <- get_extended_log(LOGFILE_Ma_2)
log_Ma_3 <- get_extended_log(LOGFILE_Ma_3)
log_Ma_4 <- get_extended_log(LOGFILE_Ma_4)
# Tanzania
log_Ta_1 <- get_extended_log(LOGFILE_Ta_1)
log_Ta_2 <- get_extended_log(LOGFILE_Ta_2)
log_Ta_3 <- get_extended_log(LOGFILE_Ta_3)
log_Ta_4 <- get_extended_log(LOGFILE_Ta_4)
# The Gambia
log_TG_2 <- get_extended_log(LOGFILE_TG_2)
log_TG_4 <- get_extended_log(LOGFILE_TG_4)
log_TG_6 <- get_extended_log(LOGFILE_TG_6)
# Vietnam
log_VN_1 <- get_extended_log(LOGFILE_VN_1)
log_VN_2 <- get_extended_log(LOGFILE_VN_2)
log_VN_4 <- get_extended_log(LOGFILE_VN_4)
get_log_length <- function(logfile){
length <- dim(logfile)[1]
return(length)
}
n_Ma <- get_log_length(log_Ma_1) + get_log_length(log_Ma_2) + get_log_length(log_Ma_3) + get_log_length(log_Ma_4)
n_Ta <- get_log_length(log_Ta_1) + get_log_length(log_Ta_2) + get_log_length(log_Ta_3) + get_log_length(log_Ta_4)
n_TG <- get_log_length(log_TG_2) + get_log_length(log_TG_4) + get_log_length(log_TG_6)
n_VN <- get_log_length(log_VN_1) + get_log_length(log_VN_2) + get_log_length(log_VN_4)
all_logs <- as.data.frame(rbind(log_Ma_1, log_Ma_2, log_Ma_3, log_Ma_4,
log_Ta_1, log_Ta_2, log_Ta_3, log_Ta_4,
log_TG_2, log_TG_4, log_TG_6,
log_VN_1, log_VN_2, log_VN_4))
all_logs$country <- c(rep("Malawi",n_Ma),rep("Tanzania",n_Ta),rep("The Gambia",n_TG),rep("Vietnam",n_VN))
all_logs$lineage <- as.factor(c(rep("L1",get_log_length(log_Ma_1)), rep("L2",get_log_length(log_Ma_2)), rep("L3",get_log_length(log_Ma_3)), rep("L4",get_log_length(log_Ma_4)),
rep("L1",get_log_length(log_Ta_1)), rep("L2",get_log_length(log_Ta_2)), rep("L3",get_log_length(log_Ta_3)), rep("L4",get_log_length(log_Ta_4)),
rep("L2",get_log_length(log_TG_2)), rep("L4",get_log_length(log_TG_4)), rep("L6",get_log_length(log_TG_6)),
rep("L1",get_log_length(log_VN_1)), rep("L2",get_log_length(log_VN_2)), rep("L4",get_log_length(log_VN_4))))
all_logs$lineage <- factor(all_logs$lineage, levels=c("L6","L4","L3","L2","L1"))
x <- seq(0,10,by=0.01)
all_lin_uninf_distr <- data.frame(country=c(rep("Malawi",4*length(x)),rep("Tanzania",4*length(x)),rep("The Gambia",3*length(x)),rep("Vietnam",3*length(x))),
lineage=c(rep("L1",length(x)),rep("L2",length(x)),rep("L3",length(x)),rep("L4",length(x)),rep("L1",length(x)),rep("L2",length(x)),rep("L3",length(x)),rep("L4",length(x)),rep("L2",length(x)),rep("L4",length(x)),rep("L6",length(x)),rep("L1",length(x)),rep("L2",length(x)),rep("L4",length(x))),
exp_x=rep(x,times=14),
exp_y=c(dexp(x,rate=get_migr_mean(log_Ma_1)),dexp(x,rate=get_migr_mean(log_Ma_2)),dexp(x,rate=get_migr_mean(log_Ma_3)),dexp(x,rate=get_migr_mean(log_Ma_4)),dexp(x,rate=get_migr_mean(log_Ta_1)),dexp(x,rate=get_migr_mean(log_Ta_2)),dexp(x,rate=get_migr_mean(log_Ta_3)),dexp(x,rate=get_migr_mean(log_Ta_4)),dexp(x,rate=get_migr_mean(log_TG_2)),dexp(x,rate=get_migr_mean(log_TG_4)),dexp(x,rate=get_migr_mean(log_TG_6)),dexp(x,rate=get_migr_mean(log_VN_1)),dexp(x,rate=get_migr_mean(log_VN_2)),dexp(x,rate=get_migr_mean(log_VN_4))))
cumulative_progression <- data.frame(country=c(rep("Malawi",4),rep("Tanzania",4),rep("The Gambia",3),rep("Vietnam",3)),
lineage=c("L1","L2","L3","L4","L1","L2","L3","L4","L2","L4","L6","L1","L2","L4"),
cum_1y_mean=c(pexp(1,rate=get_migr_mean(log_Ma_1)),pexp(1,rate=get_migr_mean(log_Ma_2)),pexp(1,rate=get_migr_mean(log_Ma_3)),pexp(1,rate=get_migr_mean(log_Ma_4)),pexp(1,rate=get_migr_mean(log_Ta_1)),pexp(1,rate=get_migr_mean(log_Ta_2)),pexp(1,rate=get_migr_mean(log_Ta_3)),pexp(1,rate=get_migr_mean(log_Ta_4)),pexp(1,rate=get_migr_mean(log_TG_2)),pexp(1,rate=get_migr_mean(log_TG_4)),pexp(1,rate=get_migr_mean(log_TG_6)),pexp(1,rate=get_migr_mean(log_VN_1)),pexp(1,rate=get_migr_mean(log_VN_2)),pexp(1,rate=get_migr_mean(log_VN_4))),
cum_1y_lower=c(pexp(1,rate=HDInterval::hdi(log_Ma_1$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ma_2$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ma_3$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ma_4$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ta_1$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ta_2$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ta_3$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ta_4$migr)[1]),pexp(1,rate=HDInterval::hdi(log_TG_2$migr)[1]),pexp(1,rate=HDInterval::hdi(log_TG_4$migr)[1]),pexp(1,rate=HDInterval::hdi(log_TG_6$migr)[1]),pexp(1,rate=HDInterval::hdi(log_VN_1$migr)[1]),pexp(1,rate=HDInterval::hdi(log_VN_2$migr)[1]),pexp(1,HDInterval::hdi(log_VN_4$migr)[1])),
cum_1y_upper=c(pexp(1,rate=HDInterval::hdi(log_Ma_1$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ma_2$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ma_3$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ma_4$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ta_1$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ta_2$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ta_3$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ta_4$migr)[2]),pexp(1,rate=HDInterval::hdi(log_TG_2$migr)[2]),pexp(1,rate=HDInterval::hdi(log_TG_4$migr)[2]),pexp(1,rate=HDInterval::hdi(log_TG_6$migr)[2]),pexp(1,rate=HDInterval::hdi(log_VN_1$migr)[2]),pexp(1,rate=HDInterval::hdi(log_VN_2$migr)[2]),pexp(1,HDInterval::hdi(log_VN_4$migr)[2])),
cum_2y_mean=c(pexp(2,rate=get_migr_mean(log_Ma_1)),pexp(2,rate=get_migr_mean(log_Ma_2)),pexp(2,rate=get_migr_mean(log_Ma_3)),pexp(2,rate=get_migr_mean(log_Ma_4)),pexp(2,rate=get_migr_mean(log_Ta_1)),pexp(2,rate=get_migr_mean(log_Ta_2)),pexp(2,rate=get_migr_mean(log_Ta_3)),pexp(2,rate=get_migr_mean(log_Ta_4)),pexp(2,rate=get_migr_mean(log_TG_2)),pexp(2,rate=get_migr_mean(log_TG_4)),pexp(2,rate=get_migr_mean(log_TG_6)),pexp(2,rate=get_migr_mean(log_VN_1)),pexp(2,rate=get_migr_mean(log_VN_2)),pexp(2,rate=get_migr_mean(log_VN_4))))
plot_Re <- function(country, x_min=0.5, x_max=1.5, lineage_labels, lineage_colours){
plot <- ggplot(all_logs[all_logs$country==country,], aes(lineage, x=Re, fill=lineage, colour=lineage)) +
geom_density_ridges(alpha=0.9, show.legend=F) +
coord_cartesian(clip = "off") +
labs(title=country) +
xlab(expression(R[e])) +
ylab("") +
theme_ipsum(axis_title_just = 'm') +
theme(axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=12, vjust=0.5),
axis.title.x = element_text(size=12, vjust=0.5),
plot.title = element_text(face="bold", size=14, hjust=0.5)) +
xlim(x_min,x_max) +
scale_fill_manual(labels=lineage_labels, values=lineage_colours) +
scale_colour_manual(labels=lineage_labels, values=lineage_colours)
return(plot)
}
x <- seq(0,10,by=0.01)
all_lin_uninf_distr <- data.frame(country=c(rep("Malawi",4*length(x)),rep("Tanzania",4*length(x)),rep("The Gambia",3*length(x)),rep("Vietnam",3*length(x))),
lineage=c(rep("L1",length(x)),rep("L2",length(x)),rep("L3",length(x)),rep("L4",length(x)),rep("L1",length(x)),rep("L2",length(x)),rep("L3",length(x)),rep("L4",length(x)),rep("L2",length(x)),rep("L4",length(x)),rep("L6",length(x)),rep("L1",length(x)),rep("L2",length(x)),rep("L4",length(x))),
exp_x=rep(x,times=14),
exp_y=c(dexp(x,rate=get_migr_mean(log_Ma_1)),dexp(x,rate=get_migr_mean(log_Ma_2)),dexp(x,rate=get_migr_mean(log_Ma_3)),dexp(x,rate=get_migr_mean(log_Ma_4)),dexp(x,rate=get_migr_mean(log_Ta_1)),dexp(x,rate=get_migr_mean(log_Ta_2)),dexp(x,rate=get_migr_mean(log_Ta_3)),dexp(x,rate=get_migr_mean(log_Ta_4)),dexp(x,rate=get_migr_mean(log_TG_2)),dexp(x,rate=get_migr_mean(log_TG_4)),dexp(x,rate=get_migr_mean(log_TG_6)),dexp(x,rate=get_migr_mean(log_VN_1)),dexp(x,rate=get_migr_mean(log_VN_2)),dexp(x,rate=get_migr_mean(log_VN_4))))
cumulative_progression <- data.frame(country=c(rep("Malawi",4),rep("Tanzania",4),rep("The Gambia",3),rep("Vietnam",3)),
lineage=c("L1","L2","L3","L4","L1","L2","L3","L4","L2","L4","L6","L1","L2","L4"),
cum_1y_mean=c(pexp(1,rate=get_migr_mean(log_Ma_1)),pexp(1,rate=get_migr_mean(log_Ma_2)),pexp(1,rate=get_migr_mean(log_Ma_3)),pexp(1,rate=get_migr_mean(log_Ma_4)),pexp(1,rate=get_migr_mean(log_Ta_1)),pexp(1,rate=get_migr_mean(log_Ta_2)),pexp(1,rate=get_migr_mean(log_Ta_3)),pexp(1,rate=get_migr_mean(log_Ta_4)),pexp(1,rate=get_migr_mean(log_TG_2)),pexp(1,rate=get_migr_mean(log_TG_4)),pexp(1,rate=get_migr_mean(log_TG_6)),pexp(1,rate=get_migr_mean(log_VN_1)),pexp(1,rate=get_migr_mean(log_VN_2)),pexp(1,rate=get_migr_mean(log_VN_4))),
cum_1y_lower=c(pexp(1,rate=HDInterval::hdi(log_Ma_1$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ma_2$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ma_3$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ma_4$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ta_1$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ta_2$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ta_3$migr)[1]),pexp(1,rate=HDInterval::hdi(log_Ta_4$migr)[1]),pexp(1,rate=HDInterval::hdi(log_TG_2$migr)[1]),pexp(1,rate=HDInterval::hdi(log_TG_4$migr)[1]),pexp(1,rate=HDInterval::hdi(log_TG_6$migr)[1]),pexp(1,rate=HDInterval::hdi(log_VN_1$migr)[1]),pexp(1,rate=HDInterval::hdi(log_VN_2$migr)[1]),pexp(1,HDInterval::hdi(log_VN_4$migr)[1])),
cum_1y_upper=c(pexp(1,rate=HDInterval::hdi(log_Ma_1$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ma_2$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ma_3$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ma_4$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ta_1$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ta_2$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ta_3$migr)[2]),pexp(1,rate=HDInterval::hdi(log_Ta_4$migr)[2]),pexp(1,rate=HDInterval::hdi(log_TG_2$migr)[2]),pexp(1,rate=HDInterval::hdi(log_TG_4$migr)[2]),pexp(1,rate=HDInterval::hdi(log_TG_6$migr)[2]),pexp(1,rate=HDInterval::hdi(log_VN_1$migr)[2]),pexp(1,rate=HDInterval::hdi(log_VN_2$migr)[2]),pexp(1,HDInterval::hdi(log_VN_4$migr)[2])),
cum_2y_mean=c(pexp(2,rate=get_migr_mean(log_Ma_1)),pexp(2,rate=get_migr_mean(log_Ma_2)),pexp(2,rate=get_migr_mean(log_Ma_3)),pexp(2,rate=get_migr_mean(log_Ma_4)),pexp(2,rate=get_migr_mean(log_Ta_1)),pexp(2,rate=get_migr_mean(log_Ta_2)),pexp(2,rate=get_migr_mean(log_Ta_3)),pexp(2,rate=get_migr_mean(log_Ta_4)),pexp(2,rate=get_migr_mean(log_TG_2)),pexp(2,rate=get_migr_mean(log_TG_4)),pexp(2,rate=get_migr_mean(log_TG_6)),pexp(2,rate=get_migr_mean(log_VN_1)),pexp(2,rate=get_migr_mean(log_VN_2)),pexp(2,rate=get_migr_mean(log_VN_4))))
log_TG_2$migr
head(log_TG_6)
head(log_TG_2)
